'use strict';
let centers: any;
let doctorName: any;
let isOpenToolbar = false;
let isBulk: boolean;

const copyToClipboard = (str: any) => {
    alert('کپی شد');
    window.navigator.clipboard.writeText(str);
};

const icons = {
    center: `
<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M7.99961 1.06665C7.86546 1.06707 7.7364 1.11802 7.63815 1.20936C7.63746 1.2097 7.63676 1.21005 7.63607 1.2104L1.99857 4.28436C1.91432 4.30627 1.83671 4.34847 1.77253 4.40728L1.7694 4.40936V4.4104C1.71591 4.46023 1.67323 4.52053 1.64403 4.58755C1.61482 4.65457 1.5997 4.72688 1.59961 4.79998C1.59961 4.94143 1.6558 5.07709 1.75582 5.17711C1.85584 5.27713 1.99149 5.33332 2.13294 5.33332V12.8C2.13294 13.3893 2.61028 13.8667 3.19961 13.8667H12.7996C13.3889 13.8667 13.8663 13.3893 13.8663 12.8V5.33332C14.0077 5.33332 14.1434 5.27713 14.2434 5.17711C14.3434 5.07709 14.3996 4.94143 14.3996 4.79998C14.3995 4.72688 14.3844 4.65457 14.3552 4.58755C14.326 4.52053 14.2833 4.46023 14.2298 4.4104C14.2298 4.41005 14.2298 4.40971 14.2298 4.40936L14.2277 4.40832C14.1634 4.34899 14.0854 4.30641 14.0007 4.28436L8.36315 1.2104L8.36107 1.20936C8.26282 1.11802 8.13376 1.06707 7.99961 1.06665ZM7.99961 5.86665C8.29401 5.86665 8.53294 6.10558 8.53294 6.39998V7.99998H10.1329C10.4273 7.99998 10.6663 8.23892 10.6663 8.53332C10.6663 8.82772 10.4273 9.06665 10.1329 9.06665H8.53294V10.6667C8.53294 10.9611 8.29401 11.2 7.99961 11.2C7.70521 11.2 7.46628 10.9611 7.46628 10.6667V9.06665H5.86628C5.57188 9.06665 5.33294 8.82772 5.33294 8.53332C5.33294 8.23892 5.57188 7.99998 5.86628 7.99998H7.46628V6.39998C7.46628 6.10558 7.70521 5.86665 7.99961 5.86665Z" fill="#fff"/>
</svg>`,
    copy: `
<svg width="16" height="16" viewBox="0 0 19 19" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path fill-rule="evenodd" clip-rule="evenodd" d="M7.12467 0.833375L7.07869 0.833374C5.92497 0.83336 4.99474 0.833348 4.25364 0.918249C3.48714 1.00606 2.82912 1.19288 2.26784 1.63338C2.03157 1.8188 1.81844 2.03194 1.63301 2.2682C1.19252 2.82948 1.00569 3.4875 0.917883 4.25401C0.832981 4.99511 0.832993 5.92534 0.833008 7.07906L0.833009 7.12504L0.833008 7.17102C0.832993 8.32475 0.832981 9.25497 0.917883 9.99607C1.00569 10.7626 1.19252 11.4206 1.63301 11.9819C1.81844 12.2181 2.03157 12.4313 2.26784 12.6167C2.82912 13.0572 3.48714 13.244 4.25364 13.3318C4.64312 13.3765 5.08484 13.3976 5.58377 13.4077C5.58575 13.8782 5.59284 14.28 5.61817 14.6245C5.65436 15.1166 5.73072 15.5506 5.91446 15.9581C6.29036 16.7918 6.95792 17.4594 7.79157 17.8353C8.19907 18.019 8.63312 18.0954 9.12519 18.1315C9.60345 18.1667 10.1922 18.1667 10.922 18.1667H10.9223H10.9511H11.8747H11.9206C13.0744 18.1667 14.0046 18.1667 14.7457 18.0818C15.5122 17.994 16.1702 17.8072 16.7315 17.3667C16.9678 17.1813 17.1809 16.9681 17.3663 16.7319C17.8068 16.1706 17.9937 15.5126 18.0815 14.7461C18.1664 14.005 18.1664 13.0747 18.1663 11.921V11.875V10.9514V10.9227V10.9226C18.1663 10.1927 18.1664 9.60386 18.1312 9.12556C18.095 8.63348 18.0186 8.19944 17.8349 7.79193C17.459 6.95829 16.7914 6.29072 15.9578 5.91483C15.5503 5.73108 15.1162 5.65473 14.6242 5.61854C14.2797 5.59321 13.8779 5.58612 13.4073 5.58414C13.3973 5.0852 13.3761 4.64349 13.3315 4.25401C13.2437 3.4875 13.0568 2.82948 12.6163 2.2682C12.4309 2.03194 12.2178 1.8188 11.9815 1.63338C11.4202 1.19288 10.7622 1.00606 9.99571 0.918249C9.25461 0.833348 8.32438 0.83336 7.17066 0.833374L7.12467 0.833375ZM13.4163 7.08425V7.12504V7.17102C13.4164 8.32474 13.4164 9.25497 13.3315 9.99607C13.2437 10.7626 13.0568 11.4206 12.6163 11.9819C12.4309 12.2181 12.2178 12.4313 11.9815 12.6167C11.4202 13.0572 10.7622 13.244 9.99571 13.3318C9.25461 13.4167 8.32438 13.4167 7.17065 13.4167H7.12467H7.08389C7.0859 13.8678 7.09249 14.2203 7.11413 14.5145C7.14424 14.9238 7.20046 15.161 7.28188 15.3416C7.50742 15.8418 7.90796 16.2423 8.40814 16.4678C8.58871 16.5493 8.82589 16.6055 9.23521 16.6356C9.65202 16.6662 10.1856 16.6667 10.9511 16.6667H11.8747C13.0852 16.6667 13.9293 16.6656 14.575 16.5916C15.2051 16.5194 15.5512 16.3862 15.8054 16.1867C15.9472 16.0755 16.0751 15.9476 16.1863 15.8058C16.3858 15.5516 16.519 15.2055 16.5912 14.5753C16.6652 13.9296 16.6663 13.0856 16.6663 11.875V10.9514C16.6663 10.186 16.6659 9.65239 16.6352 9.23557C16.6051 8.82625 16.5489 8.58907 16.4675 8.40851C16.2419 7.90832 15.8414 7.50778 15.3412 7.28225C15.1606 7.20083 14.9235 7.1446 14.5141 7.1145C14.2199 7.09286 13.8675 7.08626 13.4163 7.08425ZM3.19391 2.81338C3.44812 2.61387 3.79423 2.48069 4.42437 2.4085C5.07009 2.33453 5.91415 2.33337 7.12467 2.33337C8.3352 2.33337 9.17926 2.33453 9.82498 2.4085C10.4551 2.48069 10.8012 2.61387 11.0554 2.81338C11.1972 2.92463 11.3251 3.05251 11.4363 3.19427C11.6358 3.44848 11.769 3.79459 11.8412 4.42473C11.9152 5.07046 11.9163 5.91452 11.9163 7.12504C11.9163 8.33556 11.9152 9.17963 11.8412 9.82535C11.769 10.4555 11.6358 10.8016 11.4363 11.0558C11.3251 11.1976 11.1972 11.3255 11.0554 11.4367C10.8012 11.6362 10.4551 11.7694 9.82498 11.8416C9.17926 11.9156 8.3352 11.9167 7.12467 11.9167C5.91415 11.9167 5.07009 11.9156 4.42437 11.8416C3.79423 11.7694 3.44812 11.6362 3.19391 11.4367C3.05215 11.3255 2.92426 11.1976 2.81301 11.0558C2.6135 10.8016 2.48032 10.4555 2.40814 9.82535C2.33416 9.17963 2.33301 8.33556 2.33301 7.12504C2.33301 5.91452 2.33416 5.07046 2.40814 4.42473C2.48032 3.79459 2.6135 3.44848 2.81301 3.19427C2.92426 3.05251 3.05215 2.92463 3.19391 2.81338Z" fill="#000"/>
    </svg>
`,
    chevron: ({
        color = '#fff',
        dir = 'bottom'
    }: {
        color?: string;
        dir: 'top' | 'bottom' | 'left' | 'right';
    }) => {
        const rotateDegrees = {
            top: '270deg',
            bottom: '90deg',
            left: '180deg',
            right: '360deg'
        };
        return `
<svg width="18" height="18"  style="transition: transform 0.3s; transform: rotate(${rotateDegrees[dir]});" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<path fill-rule="evenodd" clip-rule="evenodd" d="M14.5303 5.46967C14.8232 5.76256 14.8232 6.23744 14.5303 6.53033L9.06066 12L14.5303 17.4697C14.8232 17.7626 14.8232 18.2374 14.5303 18.5303C14.2374 18.8232 13.7626 18.8232 13.4697 18.5303L7.46967 12.5303C7.17678 12.2374 7.17678 11.7626 7.46967 11.4697L13.4697 5.46967C13.7626 5.17678 14.2374 5.17678 14.5303 5.46967Z" fill="${color}"/>
</svg>

`;
    },
    close: `<svg width="17" height="17" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path fill-rule="evenodd" clip-rule="evenodd" d="M5.46967 5.46967C5.76256 5.17678 6.23744 5.17678 6.53033 5.46967L12 10.9393L17.4697 5.46967C17.7626 5.17678 18.2374 5.17678 18.5303 5.46967C18.8232 5.76256 18.8232 6.23744 18.5303 6.53033L13.0607 12L18.5303 17.4697C18.8232 17.7626 18.8232 18.2374 18.5303 18.5303C18.2374 18.8232 17.7626 18.8232 17.4697 18.5303L12 13.0607L6.53033 18.5303C6.23744 18.8232 5.76256 18.8232 5.46967 18.5303C5.17678 18.2374 5.17678 17.7626 5.46967 17.4697L10.9393 12L5.46967 6.53033C5.17678 6.23744 5.17678 5.76256 5.46967 5.46967Z" fill="#fff"/>
    </svg>
    `
};

const renderToolbarWrapper = (children?: Function[]) => {
    document.body.insertAdjacentHTML(
        'afterbegin',
        `
        <div style="background-color: #353c44;position: sticky;top: 0;z-index: 99999;font-size: 13px;width: 100%;height: 44px;display: flex;align-items: center;" id="toolbar__wrapper">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 102.473 108.85" style="width: 22px;margin-right: 10px;margin-left: 6px;"><path d="M102.418 48.483l-.9-14.9a15.113 15.113 0 00-6.371-11.29l-7.872-5.495a113.609 113.609 0 00-18.889-10.67l-10.981-4.88A14.359 14.359 0 0051.36.006a14.364 14.364 0 00-6.342 1.277L33.634 6.441a113.594 113.594 0 00-17.3 9.737l-8.918 6.1A15.117 15.117 0 00.928 33.653L.041 48.475a427.94 427.94 0 000 11.884l.893 14.9a15.125 15.125 0 006.371 11.29l7.874 5.509a113.529 113.529 0 0018.895 10.67l10.979 4.883a14.376 14.376 0 006.047 1.237 14.363 14.363 0 006.342-1.277l11.384-5.152a113.591 113.591 0 0017.3-9.737l8.918-6.1a15.115 15.115 0 006.487-11.374l.889-14.618c.036-3.182.1-8.348-.002-12.107z" fill="#fff"></path><g fill="#000"><path d="M51.755 18.448l.033.518a.26.26 0 00.219.253 1.914 1.914 0 00.24.045 23.479 23.479 0 012.359.4 35.886 35.886 0 013.636.955 36.588 36.588 0 0114.963 9.09 33.77 33.77 0 012.774 3.14c.318.408.314.4.812.253a9.2 9.2 0 011.71-.328 10.4 10.4 0 012.109.029 8.148 8.148 0 012.04.506 8.932 8.932 0 014.492 3.661 9.094 9.094 0 011.335 4.638 8.957 8.957 0 01-9.131 8.774 4.3 4.3 0 01-.537-.022 9.73 9.73 0 01-1.641-.251 8.96 8.96 0 01-6.409-5.938 8.394 8.394 0 01-.32-3.763 8.706 8.706 0 013.624-5.987c.076-.057.151-.112.223-.173.021-.014.027-.045.056-.1-.058-.086-.118-.188-.192-.28a34.47 34.47 0 00-17.482-11.512 34.762 34.762 0 00-3.2-.741c-.465-.086-.934-.149-1.4-.218-.178-.027-.263.033-.273.2-.012.241 0 .482-.012.722v.852a.178.178 0 01-.035.135.182.182 0 01-.122.069h-.05c-.513 0-1.034 0-1.54-.012-.025 0-.048-.022-.1-.049a2.748 2.748 0 01-.039-.288v-.922a2.745 2.745 0 00-.019-.32.191.191 0 00-.188-.176 1.1 1.1 0 00-.163 0l-1.784.067a7.516 7.516 0 00-.771.045c-.579.061-1.158.12-1.732.2s-1.149.18-1.722.28c-.827.143-1.641.339-2.45.559a32.717 32.717 0 00-15.457 9.339 31.7 31.7 0 00-4.91 7 31.007 31.007 0 00-1.96 4.693 30.39 30.39 0 00-.806 3.02q-.271 1.255-.44 2.524c-.087.649-.128 1.3-.182 1.957-.029.345-.048.692-.06 1.041 0 .245.052.3.3.32h3.891a1.025 1.025 0 01.5.055.722.722 0 01.054.175 10.1 10.1 0 01-.043 1.581 1.171 1.171 0 01-.207.049h-3.93a.728.728 0 00-.471.071.548.548 0 00-.045.353 15.119 15.119 0 00.138 1.757c.058.355.085.716.13 1.073.087.69.223 1.371.364 2.051.207.957.453 1.9.74 2.828a30.667 30.667 0 001.9 4.681 32.545 32.545 0 0020.931 16.732c.891.229 1.79.424 2.687.575.786.133 1.579.222 2.373.308 1.108.116 2.216.127 3.326.149.207 0 .413 0 .61-.016s.244-.075.24-.255c0-.308-.021-.612-.043-.922-.083-1.161-.076-2.324-.074-3.485a2.313 2.313 0 01.9-1.81 3.591 3.591 0 011.6-.733c.7-.155 1.4-.308 2.1-.451.529-.108 1.063-.2 1.594-.3.267-.049.531-.1.8-.141.4-.065.8-.141 1.2-.19a11.017 11.017 0 012.183-.143 3.653 3.653 0 01.757.135 1.577 1.577 0 01.874.622 22.25 22.25 0 011.28 1.9c.323.571.682 1.124 1.034 1.683a1.021 1.021 0 00.12.161.231.231 0 00.292.071 1.81 1.81 0 00.248-.135c1.679-1.079 3.341-2.183 4.937-3.383a26.169 26.169 0 005.24-5.336c.329-.443.668-.875.99-1.322.258-.359.5-.73.742-1.1a1.246 1.246 0 00.178-.847 1.938 1.938 0 00-.684-1.326 22.392 22.392 0 00-1.937-1.52 3.58 3.58 0 01-1.383-1.59 3.185 3.185 0 01-.124-2.04l.413-1.673.566-2.289q.285-1.126.566-2.255a4.987 4.987 0 01.395-1.09 2.54 2.54 0 012.03-1.357 8.235 8.235 0 011.9-.025c.984.094 1.97.169 2.954.245.351.027.7.029 1.056.039a21.153 21.153 0 012.275.123 3.131 3.131 0 01.825.228 1.829 1.829 0 011.05 1.2 2.541 2.541 0 01.089 1.3c-.089.408-.11.816-.176 1.224-.107.671-.207 1.345-.349 2.012-.155.759-.339 1.512-.515 2.267a26.44 26.44 0 01-.8 2.689 34.952 34.952 0 01-3.835 7.939 36.847 36.847 0 01-3.376 4.409 39.54 39.54 0 01-6.408 5.785 36.628 36.628 0 01-6.408 3.752 45.494 45.494 0 01-4.066 1.61c-.947.32-1.912.577-2.894.816s-1.958.418-2.942.586c-.506.086-1.021.118-1.532.184a9.246 9.246 0 01-1.54.082 2.212 2.212 0 01-.827-.165 1.494 1.494 0 01-.657-.577 2.633 2.633 0 01-.356-.847c-.037-.155-.089-.3-.136-.463a2.373 2.373 0 00-.3-.035h-.934a30.235 30.235 0 01-3.243-.157 35.41 35.41 0 01-2.375-.3 35.245 35.245 0 01-7.8-2.153A35.674 35.674 0 0118.573 70.49a33.81 33.81 0 01-3.746-9.611c-.246-1.1-.413-2.2-.579-3.314-.083-.6-.12-1.192-.159-1.8-.056-.894-.128-1.787-.1-2.683.033-1.081.091-2.163.207-3.24q.112-1.139.3-2.265c.151-.879.333-1.757.56-2.624s.469-1.7.748-2.536a33.713 33.713 0 011.985-4.693 35 35 0 015.315-7.631 36.216 36.216 0 0115.869-10.031 28.409 28.409 0 013.1-.8c.544-.1 1.083-.241 1.631-.326.734-.114 1.472-.2 2.212-.284a38.71 38.71 0 011.982-.159c.757-.039 1.515-.053 2.274-.071h1.178c.123.001.236.015.405.026zM85.79 42.093a6.459 6.459 0 00-10.264-5.728 6.8 6.8 0 00-.781.653 6.2 6.2 0 00-.058 8.841l.017.018a6.43 6.43 0 003.942 1.875 6.2 6.2 0 003.514-.612 6.067 6.067 0 003.63-5.047z"></path><path d="M49.163 59.565c.012.171.029.288.029.408v3.008c0 .441-.012.447-.455.455h-14.3a1.34 1.34 0 01-.575-.053.788.788 0 01-.015-.5 10.7 10.7 0 011.633-4.026 18 18 0 011.759-2.151c1.141-1.224 2.369-2.347 3.593-3.483.75-.7 1.48-1.412 2.2-2.134a6.8 6.8 0 001.226-1.588 4.888 4.888 0 00.569-1.787 3.447 3.447 0 00-.267-1.765 2.406 2.406 0 00-1.575-1.406 3.821 3.821 0 00-2.51.053 2.533 2.533 0 00-1.557 1.585 4.063 4.063 0 00-.269 1.21 1.95 1.95 0 01-.056.269.847.847 0 01-.176.024q-2-.184-4-.375c-.021 0-.041-.031-.089-.067a1.8 1.8 0 010-.333 10.3 10.3 0 01.68-2.383 5.644 5.644 0 012.855-2.84 8.491 8.491 0 012.638-.745 11.561 11.561 0 011.7-.09 8.783 8.783 0 013.132.6 5.979 5.979 0 013.543 3.691 6.45 6.45 0 01.265 2.887 8.835 8.835 0 01-1.716 4.144 14.346 14.346 0 01-1.978 2.228c-1.034.959-2.088 1.9-3.132 2.857a11.833 11.833 0 00-1.428 1.477c-.147.19-.287.388-.413.59-.074.112-.017.2.126.218a3.983 3.983 0 00.413 0h7.6c.153.006.327.016.55.022zm16.935-.74c-.176 0-.325.018-.471.018h-1.86a.751.751 0 00-.432.065.95.95 0 00-.056.473v3.528c0 .145-.012.29-.017.422a.627.627 0 01-.453.09h-3.384a2.248 2.248 0 01-.26-.029.4.4 0 01-.1-.353v-3.683c0-.145-.012-.288-.021-.445a1.47 1.47 0 00-.252-.059h-8.571a1.342 1.342 0 01-.54-.053 1.473 1.473 0 01-.05-.265v-3.246a.856.856 0 01.207-.512q1.079-1.53 2.152-3.061l7.341-10.439c.337-.477.223-.424.827-.428h2.625a.978.978 0 01.453.053 1.667 1.667 0 01.046.224v13.361c0 .147 0 .294.012.441a.164.164 0 00.157.155c.107 0 .207.012.325.012h1.916a3.944 3.944 0 01.413.014.972.972 0 01.045.2v3.328a1.25 1.25 0 01-.052.189zm-7.12-11.386c-.1.131-.163.2-.207.273l-3.163 4.583-1.654 2.383c-.072.1-.18.2-.178.333.037.031.058.061.079.061q2.48.012 4.961.016a.325.325 0 00.256-.559v-6.86a1.1 1.1 0 00-.093-.222zm26.148-6.366a5.736 5.736 0 01-3.572 5.65 5.95 5.95 0 01-2.778.408 5.775 5.775 0 01-5-3.877 5.193 5.193 0 01-.269-2.33 5.629 5.629 0 013.326-4.613 5.324 5.324 0 012.836-.543 5.756 5.756 0 015.125 3.732 4.515 4.515 0 01.332 1.573zm-5.848-2.155a2.544 2.544 0 00-2.584 2.479 2.576 2.576 0 002.557 2.532 2.542 2.542 0 002.592-2.489 2.467 2.467 0 00-.718-1.767 2.534 2.534 0 00-1.775-.747z"></path><path d="M79.305 40.449a1.028 1.028 0 011.054.979 1.048 1.048 0 01-1.015 1.081h-.039a1.066 1.066 0 01-1.034-1.02 1.008 1.008 0 01.972-1.041z"></path></g></svg>
        ${children?.length ? children?.map(item => item()) : ''}</div>
    `
    );
};

const renderToolBarContent = (isShow: boolean, children?: Function[]) => {
    isShow
        ? document.getElementById('toolbar__wrapper')?.insertAdjacentHTML(
              'afterbegin',
              `
        <div style="background-color: #24292e;position: fixed;top: 44px;z-index: 99999;font-size: 13px;width: 100%;padding: 20px;display: flex;flex-direction: column;align-items: center;gap: 30px;" id="toolbar__content">${
            children?.length ? children?.map(item => item()) : ''
        }
        <button style="
        display: flex;
        background: #3f464e;
        padding: 7px 20px;
        color: #ffffffd6;
        border-radius: 100px;"
        id="toolbar__closeContent"
    >${icons.close}بستن</button>
        </div>
    `
          )
        : document.getElementById('toolbar__content')?.remove();

    document.getElementById('toolbar__closeContent')?.addEventListener('click', () => {
        isOpenToolbar = false;
        renderToolBarContent(false);
    });
};

const centersManagment = () => {
    return `
        <button style="padding: 0 10px; color: #fff;display: flex;align-items: center;gap: 5px;" id="toolbar__settingButton"> 
            ${icons.center}
            <span>تنظیمات مراکز</span>
        </button>
    `;
};

const doctorInfo = () => {
    return `
    <button style="padding: 0 10px; color: #fff;display: flex;align-items: center;gap: 5px;" onClick="alert(window.doctor?.id)"> 
            <span>${doctorName}</span>
            <span style="
            font-size: 11px;
            color: ${isBulk ? '#e1a776' : '#76e1b5'};
        ">${isBulk ? 'نوبت دهی غیرفعال' : 'نوبت دهی فعال'}</span>
        </button>
    `;
};

const copyCenterId = (e: any, id: string) => {
    e.stopPropagation();
    copyToClipboard(id);
};

const components = {
    centers: () => {
        return `<div style="display: grid;width: 100%;grid-template-columns: repeat(3, minmax(10px, 1fr));column-gap: 10px;row-gap: 15px;">${centers
            .map(({ id, name, server_id }: any) => {
                return `
<div style="
    display: flex;
    flex-direction: column;
    background: #fff;
    justify-content: flex-start;
    padding: 15px;
    font-size: 0.95rem;
    font-weight: 600;
    border-radius: 0.4rem;
    cursor: pointer;
    color: #000;
    margin-left: 5px;
    gap: 0.7rem;"
    ${
        server_id !== 1 &&
        `onclick="alert('Currently, it is only possible to open the panel of cloud centers.')"`
    }
    ${
        server_id === 1 &&
        `onclick=window.open('http://cert.paziresh24.com/admin/centers/${id}/certificate/create')`
    }
  >
        <div style="display: flex; justify-content: space-between;">
            <span style="margin-left: 20px;">
                ${name}
            </span>
            ${icons.chevron({ color: '#000', dir: 'right' })}
        </div>
        <div style="display:flex;gap:0.3rem;" onclick="copyCenterId(event, '${id}')">
            ${icons.copy}
            <span style="font-size:0.8rem;font-weight:400;opacity:0.7;white-space:nowrap">${id}</span>
        </div>
</div>`;
            })
            .join('')}</div>`;
    }
};

const centersManagmentActions = () => {
    document.getElementById('toolbar__settingButton')?.addEventListener('click', () => {
        isOpenToolbar = !isOpenToolbar;
        renderToolBarContent(isOpenToolbar, [components.centers]);
    });
};

function listDisableDoctor() {
    return window?.doctor?.centers.filter((center: any) => {
        const hours = center.services.map((ho: any) => ho.hours_of_work === null);
        const canBooking = center.services.map((cb: any) => +cb.can_booking == 0);
        const getcanBooking = canBooking.every(Boolean);
        const getHours = hours.every(Boolean);

        return (
            +center.settings.disable_booking == 1 ||
            center.services == null ||
            getcanBooking ||
            getHours
        );
    });
}

if (location.pathname.startsWith('/dr')) {
    const interval = setInterval(() => {
        centers = window.doctor?.centers;
        if (centers) {
            clearInterval(interval);

            doctorName = window.doctor?.name + ' ' + window.doctor?.family;
            isBulk =
                window?.doctor?.centers.filter((center: any) => +center.status == 2)?.length ===
                    centers?.length || listDisableDoctor()?.length === centers?.length;
            renderToolbarWrapper([doctorInfo, centersManagment]);
            centersManagmentActions();
        }
    }, 1000);
}

window.addEventListener('message', function (msg) {
    if (msg.data.type === 'urlChange') {
        document.getElementById('toolbar__wrapper')?.remove();

        if (location.pathname.startsWith('/dr')) {
            centers = window.doctor?.centers;
            doctorName = window.doctor?.name + ' ' + window.doctor?.family;
            isBulk =
                centers?.filter((center: any) => +center.status == 2).length === centers?.length ||
                listDisableDoctor()?.length === centers?.length;
            renderToolbarWrapper([doctorInfo, centersManagment]);
            centersManagmentActions();
        }
    }
});
